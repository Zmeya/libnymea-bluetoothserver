<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="648" height="1077"><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="648" height="1077"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="239.25430289469722" y="22.6179738" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encryption flow</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 88.511670804 L 114.51610218117187 1077.6710583240003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 531.9591707835156 88.511670804 L 531.9591707835156 1077.6710583240003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 78.00576818064161 47.799317964000004 L 151.02643618170214 47.799317964000004 L 151.02643618170214 88.511670804 L 78.00576818064161 88.511670804 L 78.00576818064161 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="94.3661025626416" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 425.0155005250507 47.799317964000004 L 638.9028410419804 47.799317964000004 L 638.9028410419804 88.511670804 L 425.0155005250507 88.511670804 L 425.0155005250507 47.799317964000004 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><g/><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="441.3758349070507" y="73.43302160400002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">nymea-networkmanager</text></g></g><g><g><g><rect fill="white" stroke="none" x="248.04250475175783" y="118.668969204" width="150.39026346117188" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.30430213175782" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bluetooth.connect()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 138.27121316400002 L 519.5444162755156 138.27121316400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(531.9591707835156,138.27121316400002) translate(-531.9591707835156,-138.27121316400002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 519.3936297835155 131.98844266400002 L 531.9591707835156 138.27121316400002 L 519.3936297835155 144.55398366400001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="215.49250932939455" y="160.889186964" width="215.49025430589845" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="217.75430670939454" y="174.459971244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bluetooth.discoverServices()</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 180.491430924 L 519.5444162755156 180.491430924" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(531.9591707835156,180.491430924) translate(-531.9591707835156,-180.491430924)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 519.3936297835155 174.20866042400002 L 531.9591707835156 180.491430924 L 519.3936297835155 186.774201424 Z"/></g></g><g><g><rect fill="white" stroke="none" x="285.1591734529297" y="203.109404724" width="76.15692605882812" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="287.4209708329297" y="216.680189004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">[services]</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 531.9591707835156 222.711648684 L 126.93085668917188 222.711648684" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(114.51610218117187,222.711648684) translate(-114.51610218117187,-222.711648684)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.08164318117187 216.428878184 L 114.51610218117187 222.711648684 L 127.08164318117187 228.994419184 Z"/></g></g><g><g><rect fill="white" stroke="none" x="132.3591704011719" y="245.32962248400003" width="381.75693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="134.62096778117188" y="258.900406764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bluetooth.enableNotifications(senderCharacteristc)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 264.93186644400004 L 519.5444162755156 264.93186644400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(531.9591707835156,264.93186644400004) translate(-531.9591707835156,-264.93186644400004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 519.3936297835155 258.649095944 L 531.9591707835156 264.93186644400004 L 519.3936297835155 271.21463694400006 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 100.94531790117188 287.54984024400005 L 531.9591707835156 287.54984024400005 L 545.5299550635156 301.12062452400005 L 545.5299550635156 322.23073340400003 L 100.94531790117188 322.23073340400003 L 100.94531790117188 287.54984024400005 M 531.9591707835156 287.54984024400005 L 531.9591707835156 301.12062452400005 L 545.5299550635156 301.12062452400005" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="221.68763343058595" y="308.65994912400004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Bluetooth connection ready</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 15.339327651757813 344.84870720400005 L 200.12209243058595 344.84870720400005 L 213.69287671058595 358.41949148400005 L 213.69287671058595 379.52960036400003 L 15.339327651757813 379.52960036400003 L 15.339327651757813 344.84870720400005 M 200.12209243058595 344.84870720400005 L 200.12209243058595 358.41949148400005 L 213.69287671058595 358.41949148400005" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="36.44943653175781" y="365.9588160840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate EC key pair</text></g><g><g><rect fill="white" stroke="none" x="255.54250475175783" y="402.14757416400005" width="134.59026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="255.54250475175783" y="417.226223364" width="135.39026346117188" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="257.8043021317578" y="415.71835844400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">InitiateEncryption</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="257.8043021317578" y="430.797007644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(client public key)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 436.82846732400003 L 519.5444162755156 436.82846732400003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(531.9591707835156,436.82846732400003) translate(-531.9591707835156,-436.82846732400003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 519.3936297835155 430.545696824 L 531.9591707835156 436.82846732400003 L 519.3936297835155 443.11123782400006 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 432.7823962541015 459.44644112400005 L 617.5651610329296 459.44644112400005 L 631.1359453129296 473.01722540400004 L 631.1359453129296 494.127334284 L 432.7823962541015 494.127334284 L 432.7823962541015 459.44644112400005 M 617.5651610329296 459.44644112400005 L 617.5651610329296 473.01722540400004 L 631.1359453129296 473.01722540400004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="453.8925051341015" y="480.5565500040001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate EC key pair</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 434.0990619035156 516.745308084 L 616.2484953835155 516.745308084 L 629.8192796635155 530.316092364 L 629.8192796635155 551.426201244 L 434.0990619035156 551.426201244 L 434.0990619035156 516.745308084 M 616.2484953835155 516.745308084 L 616.2484953835155 530.316092364 L 629.8192796635155 530.316092364" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="455.20917078351556" y="537.855416964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Calculate shared key</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 422.51572602705073 574.0441750440001 L 627.8318312599804 574.0441750440001 L 641.4026155399804 587.6149593240001 L 641.4026155399804 623.803717404 L 422.51572602705073 623.803717404 L 422.51572602705073 574.0441750440001 M 627.8318312599804 574.0441750440001 L 627.8318312599804 587.6149593240001 L 641.4026155399804 587.6149593240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.6258349070507" y="595.154283924" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Generate challenge and</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="443.6258349070507" y="610.2329331239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">encrypt data.</text></g><g><g><rect fill="white" stroke="none" x="143.30916734941408" y="646.4216912040001" width="214.35692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="143.30916734941408" y="661.5003404040001" width="359.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="145.57096472941407" y="659.9924754840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Response InitiateEncryption </text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="145.57096472941407" y="675.0711246840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(server public key, nonce, encrypted challenge) </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 531.9591707835156 681.1025843640001 L 126.93085668917188 681.1025843640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(114.51610218117187,681.1025843640001) translate(-114.51610218117187,-681.1025843640001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.08164318117187 674.8198138640001 L 114.51610218117187 681.1025843640001 L 127.08164318117187 687.3853548640001 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 8.50599177529297 703.7205581640002 L 206.9554283070508 703.7205581640002 L 220.5262125870508 717.2913424440002 L 220.5262125870508 753.4801005240001 L 8.50599177529297 753.4801005240001 L 8.50599177529297 703.7205581640002 M 206.9554283070508 703.7205581640002 L 206.9554283070508 717.2913424440002 L 220.5262125870508 717.2913424440002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="29.616100655292968" y="724.830667044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Calculate shared key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="29.616100655292968" y="739.909316244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">using server public key</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 776.0980743240002 L 207.92209548234376 776.0980743240002 L 221.49287976234376 789.6688586040002 L 221.49287976234376 810.7789674840002 L 7.5393246000000005 810.7789674840002 L 7.5393246000000005 776.0980743240002 M 207.92209548234376 776.0980743240002 L 207.92209548234376 789.6688586040002 L 221.49287976234376 789.6688586040002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943348" y="797.2081832040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Decrypt challenge data</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 19.55599482705078 833.3969412840003 L 195.90542525529298 833.3969412840003 L 209.47620953529298 846.9677255640003 L 209.47620953529298 883.1564836440002 L 19.55599482705078 883.1564836440002 L 19.55599482705078 833.3969412840003 M 195.90542525529298 833.3969412840003 L 195.90542525529298 846.9677255640003 L 209.47620953529298 846.9677255640003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="40.66610370705078" y="854.5070501640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Calculate SHA3-256</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="40.66610370705078" y="869.5856993640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">from challenge data</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 45.25599177529297 905.7744574440003 L 170.2054283070508 905.7744574440003 L 183.7762125870508 919.3452417240003 L 183.7762125870508 940.4553506040003 L 45.25599177529297 940.4553506040003 L 45.25599177529297 905.7744574440003 M 170.2054283070508 905.7744574440003 L 170.2054283070508 919.3452417240003 L 183.7762125870508 919.3452417240003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="66.36610065529297" y="926.8845663240003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Encrypt hash</text></g><g><g><rect fill="white" stroke="none" x="192.47583910234377" y="963.0733244040002" width="261.52359476" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="194.73763648234376" y="976.6441086840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">ConfirmChallenge(encrypted hash)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 114.51610218117187 982.6755683640002 L 519.5444162755156 982.6755683640002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(531.9591707835156,982.6755683640002) translate(-531.9591707835156,-982.6755683640002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 519.3936297835155 976.3927978640003 L 531.9591707835156 982.6755683640002 L 519.3936297835155 988.9583388640002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="217.8591704011719" y="1005.2935421640003" width="210.75693216234376" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="220.12096778117188" y="1018.8643264440003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Response ConfirmChallenge</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 531.9591707835156 1024.8957861240003 L 126.93085668917188 1024.8957861240003" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(114.51610218117187,1024.8957861240003) translate(-114.51610218117187,-1024.8957861240003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 127.08164318117187 1018.6130156240004 L 114.51610218117187 1024.8957861240003 L 127.08164318117187 1031.1785566240003 Z"/></g></g></g><g/><g/></g></svg>